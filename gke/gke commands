gcloud compute --project=wp-search-bot firewall-rules create elk-1-tcp-9200 --description=elk-1-tcp-9200 --direction=INGRESS --priority=1000 --network=default --action=ALLOW --rules=tcp:9200 --source-ranges=0.0.0.0/0 --target-tags=elk-1-tcp-9200
gcloud compute --project=wp-search-bot firewall-rules create elk-1-tcp-9300 --description=elk-1-tcp-9300 --direction=INGRESS --priority=1000 --network=default --action=ALLOW --rules=tcp:9300 --source-ranges=0.0.0.0/0 --target-tags=elk-1-tcp-9300

gcloud beta container --project "wp-search-bot" clusters create "wp-search-cluster" \
--zone "us-east1-b" --username "admin" --cluster-version "1.10.6-gke.2" \
--machine-type "n1-standard-1" --image-type "COS" --disk-type "pd-standard" \
--disk-size "100" --scopes "https://www.googleapis.com/auth/devstorage.read_only","https://www.googleapis.com/auth/logging.write","https://www.googleapis.com/auth/monitoring","https://www.googleapis.com/auth/servicecontrol","https://www.googleapis.com/auth/service.management.readonly","https://www.googleapis.com/auth/trace.append" \
--num-nodes "1" --enable-cloud-logging --enable-cloud-monitoring \
--network "projects/wp-search-bot/global/networks/default" \
--subnetwork "projects/wp-search-bot/regions/us-east1/subnetworks/default" \
--addons HorizontalPodAutoscaling,HttpLoadBalancing --no-enable-autoupgrade \
--enable-autorepair

sh ./Docker/docker-build-push.sh
kubectl apply -f gke/wp-es-demo.yaml
kubectl replace --force -f gke/wp-es-demo.yaml
kubectl apply -f gke/wp-es-demo-service.yaml

gcloud dns --project=wp-search-bot managed-zones create chatbotzlabs --description=chatbotzlabs.com --dns-name=chatbotzlabs.com.

gcloud dns --project=wp-search-bot record-sets transaction start --zone=chatbotzlabs
gcloud dns --project=wp-search-bot record-sets transaction add 35.237.246.27 --name=search.chatbotzlabs.com. --ttl=300 --type=A --zone=chatbotzlabs
gcloud dns --project=wp-search-bot record-sets transaction execute --zone=chatbotzlabs

gcloud dns --project=wp-search-bot record-sets transaction start --zone=chatbotzlabs
gcloud dns --project=wp-search-bot record-sets transaction add 35.196.209.4 --name=api.chatbotzlabs.com. --ttl=300 --type=A --zone=chatbotzlabs
gcloud dns --project=wp-search-bot record-sets transaction execute --zone=chatbotzlabs

gcloud auth configure-docker
docker tag garystafford/wp-es-demo:latest gcr.io/wp-search-bot/wp-es-demo:latest
docker push gcr.io/wp-search-bot/wp-es-demo:latest
